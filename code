def check_strength(password):
    """
    This function checks the strength of a password
    based on different conditions and returns strength.
    """
    score = 0

    # Check password length
    if len(password) >= 8:
        score += 1

    # Check lowercase characters
    if any(char.islower() for char in password):
        score += 1

    # Check uppercase characters
    if any(char.isupper() for char in password):
        score += 1

    # Check digits
    if any(char.isdigit() for char in password):
        score += 1

    # Decide strength
    if score <= 2:
        return "Weak"
    elif score == 3:
        return "Medium"
    else:
        return "Strong"


# =========================
# DATA STRUCTURES
# =========================

# List (Array) → stores all passwords
password_manager = []

# Stack → keeps track of last added passwords (LIFO)
password_stack = []

# Queue → keeps passwords in order of addition (FIFO)
password_queue = []


# =========================
# DISPLAY FUNCTIONS
# =========================

def display_menu():
    print("\n========= PASSWORD MANAGER =========")
    print("1. Add new password")
    print("2. View all saved passwords")
    print("3. Undo last added password (Stack)")
    print("4. View password queue (FIFO)")
    print("5. Search password by service")
    print("6. Exit")
    print("===================================")


def display_passwords():
    """
    Traverses the password list and displays stored passwords
    """
    if not password_manager:
        print("No passwords saved yet.")
    else:
        print("\n--- Saved Passwords ---")
        for i, item in enumerate(password_manager, start=1):
            print(f"{i}. Service: {item[0]} | Password: {item[1]} | Strength: {item[2]}")


def undo_last_password():
    """
    Removes the last added password using stack (LIFO)
    """
    if not password_stack:
        print("Stack is empty. Nothing to undo.")
        return

    last_item = password_stack.pop()

    if last_item in password_manager:
        password_manager.remove(last_item)

    print("Last password removed successfully!")

def show_queue():
    """
    Displays passwords in the order they were added
    """
    if not password_queue:
        print("Queue is empty.")
    else:
        print("\n--- Password Queue (FIFO) ---")
        for i, item in enumerate(password_queue, start=1):
            print(f"{i}. Service: {item[0]} | Strength: {item[2]}")


def search_password(service_name):
    """
    Performs linear search on password list
    """
    found = False
    for item in password_manager:
        if item[0].lower() == service_name.lower():
            print("\nPassword Found!")
            print(f"Service: {item[0]}")
            print(f"Password: {item[1]}")
            print(f"Strength: {item[2]}")
            found = True
            break

    if not found:
        print("Password not found.")


while True:
    display_menu()
    choice = input("Enter your choice: ")

    # ADD PASSWORD
    if choice == "1":
        service = input("Enter website / email / username: ")
        password = input("Enter password: ")

        strength = check_strength(password)

        record = (service, password, strength)

        # Add to list
        password_manager.append(record)

        # Push to stack
        password_stack.append(record)

        # Enqueue to queue
        password_queue.append(record)

        print("Password saved successfully!")
        print("Password Strength:", strength)

    # VIEW PASSWORDS
    elif choice == "2":
        display_passwords()

    # UNDO USING STACK
    elif choice == "3":
        undo_last_password()

    # VIEW QUEUE
    elif choice == "4":
        show_queue()

    # SEARCH PASSWORD
    elif choice == "5":
        service_name = input("Enter service name to search: ")
        search_password(service_name)

    # EXIT PROGRAM
    elif choice == "6":
        print("Exiting Password Manager...")
        break

    # INVALID INPUT
    else:
        print("Invalid choice. Please try again.")
